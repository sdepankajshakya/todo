{"ast":null,"code":"import { Subscription } from 'rxjs';\nimport { ColorPaletteComponent } from '../shared/components/color-palette/color-palette.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/task.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"../services/shared.service\";\nimport * as i4 from \"@angular/material/bottom-sheet\";\nimport * as i5 from \"../shared/services/notification.service\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"@angular/cdk/drag-drop\";\nimport * as i8 from \"../task/task.component\";\nimport * as i9 from \"@angular/material/card\";\nimport * as i10 from \"@angular/material/form-field\";\nimport * as i11 from \"@angular/material/input\";\nimport * as i12 from \"@angular/forms\";\nimport * as i13 from \"@angular/material/button\";\nimport * as i14 from \"@angular/material/icon\";\nconst _c0 = function (a0, a1) {\n  return {\n    item: a0,\n    index: a1\n  };\n};\nfunction DashboardComponent_ng_container_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"div\", 12);\n    i0.ɵɵlistener(\"cdkDropListDropped\", function DashboardComponent_ng_container_2_Template_div_cdkDropListDropped_1_listener($event) {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return ctx_r3.drop($event);\n    });\n    i0.ɵɵelementStart(2, \"div\", 13)(3, \"div\", 14);\n    i0.ɵɵelement(4, \"img\", 15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"app-task\", 16);\n    i0.ɵɵlistener(\"getBoard\", function DashboardComponent_ng_container_2_Template_app_task_getBoard_5_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r5 = i0.ɵɵnextContext();\n      return ctx_r5.getBoard();\n    });\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementContainerEnd();\n  }\n  if (rf & 2) {\n    const task_r1 = ctx.$implicit;\n    const i_r2 = ctx.index;\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"cdkDropListData\", i0.ɵɵpureFunction2(3, _c0, task_r1, i_r2));\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"task\", task_r1)(\"board\", ctx_r0.board);\n  }\n}\nconst _c1 = function (a0) {\n  return {\n    background: a0\n  };\n};\nexport let DashboardComponent = /*#__PURE__*/(() => {\n  class DashboardComponent {\n    constructor(taskService, activeRoute, sharedService, bottomSheet, notifier) {\n      this.taskService = taskService;\n      this.activeRoute = activeRoute;\n      this.sharedService = sharedService;\n      this.bottomSheet = bottomSheet;\n      this.notifier = notifier;\n      this.taskName = '';\n      this.board = {\n        name: '',\n        isProtected: false,\n        password: '',\n        dateCreated: null,\n        tasks: [],\n        bgColor: ''\n      };\n      this.changeBoardColor = false;\n      this.colorChangeSubscription = new Subscription();\n      this.colorChangeSubscription = this.sharedService.$color.subscribe(paint => {\n        const color = paint;\n        this.setBoardColor(color);\n      });\n    }\n    ngOnInit() {\n      const params = this.activeRoute.snapshot.params;\n      if (params && params.name) this.board.name = params.name;\n      this.getBoard();\n    }\n    getBoard() {\n      if (this.board) {\n        this.taskService.getBoard(this.board).subscribe(res => {\n          this.board = res.data;\n        }, err => {\n          throw new Error(err.message);\n        });\n      }\n    }\n    addTask() {\n      if (!this.taskName) return;\n      const task = {\n        name: this.taskName,\n        dueDate: null,\n        priority: 0,\n        subtasks: [],\n        boardName: this.board.name,\n        bgColor: '#ffffff',\n        isDark: false\n      };\n      this.board.tasks.push(task);\n      this.saveNewTask(task);\n    }\n    saveNewTask(task) {\n      this.taskService.newTask(task).subscribe(res => {\n        const response = res;\n        this.reset();\n        this.getBoard();\n        this.notifier.showSuccess(response.message);\n        let el = document.getElementById('footer');\n        el === null || el === void 0 ? void 0 : el.scrollIntoView({\n          behavior: 'smooth'\n        });\n      }, err => {\n        throw new Error(err.message);\n      });\n    }\n    reset() {\n      this.taskName = '';\n    }\n    drop(event) {\n      this.board.tasks[event.previousContainer.data.index] = event.container.data.item;\n      this.board.tasks[event.container.data.index] = event.previousContainer.data.item;\n      this.updateBoard();\n    }\n    updateBoard() {\n      this.taskService.updateBoard(this.board).subscribe(res => {}, err => {\n        throw new Error(err.message);\n      });\n    }\n    setBoardColor(color) {\n      if (this.changeBoardColor) {\n        this.board.bgColor = color;\n        this.updateBoard();\n        this.changeBoardColor = false;\n      }\n    }\n    openColorPalette() {\n      this.changeBoardColor = true;\n      this.bottomSheet.open(ColorPaletteComponent);\n    }\n    sortByDate() {\n      const future = new Date(8640000000000000);\n      this.board.tasks.sort((a, b) => {\n        let dateA = a.dueDate ? new Date(a.dueDate) : future;\n        let dateB = b.dueDate ? new Date(b.dueDate) : future;\n        return dateA.getTime() - dateB.getTime();\n      });\n    }\n    ngOnDestroy() {\n      this.colorChangeSubscription.unsubscribe();\n    }\n  }\n  DashboardComponent.ɵfac = function DashboardComponent_Factory(t) {\n    return new (t || DashboardComponent)(i0.ɵɵdirectiveInject(i1.TaskService), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i3.SharedService), i0.ɵɵdirectiveInject(i4.MatBottomSheet), i0.ɵɵdirectiveInject(i5.NotificationService));\n  };\n  DashboardComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: DashboardComponent,\n    selectors: [[\"app-dashboard\"]],\n    decls: 15,\n    vars: 8,\n    consts: [[1, \"board\", 3, \"ngStyle\"], [\"cdkDropListGroup\", \"\", 1, \"cards-list\", 3, \"ngStyle\"], [4, \"ngFor\", \"ngForOf\"], [\"id\", \"footer\"], [1, \"footer\"], [\"src\", \"../../assets/icons/palette.png\", 1, \"color-picker-icon\", 3, \"click\"], [\"src\", \"../../assets/icons/sort.png\", 1, \"sort-icon\", 3, \"click\"], [1, \"add-task\"], [1, \"form-field\"], [\"matInput\", \"\", \"type\", \"text\", \"placeholder\", \"name of task\", 3, \"ngModel\", \"ngModelChange\", \"keyup.enter\"], [\"matSuffix\", \"\", \"mat-icon-button\", \"\", \"aria-label\", \"Add Task\", 3, \"click\"], [1, \"icon-2x\", \"green\"], [\"cdkDropList\", \"\", \"cdkDropListOrientation\", \"horizontal\", 3, \"cdkDropListData\", \"cdkDropListDropped\"], [\"cdkDrag\", \"\", 1, \"box\"], [\"cdkDragHandle\", \"\", 1, \"cdk-drag-handle\"], [\"aria-hidden\", \"\", \"src\", \"../../assets/icons/move.png\", \"alt\", \"move-icon\", 1, \"move-icon\"], [3, \"task\", \"board\", \"getBoard\"]],\n    template: function DashboardComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"section\", 0)(1, \"div\", 1);\n        i0.ɵɵtemplate(2, DashboardComponent_ng_container_2_Template, 6, 6, \"ng-container\", 2);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(3, \"section\", 3)(4, \"mat-card\", 4)(5, \"img\", 5);\n        i0.ɵɵlistener(\"click\", function DashboardComponent_Template_img_click_5_listener() {\n          return ctx.openColorPalette();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"img\", 6);\n        i0.ɵɵlistener(\"click\", function DashboardComponent_Template_img_click_6_listener() {\n          return ctx.sortByDate();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"div\", 7)(8, \"mat-form-field\", 8)(9, \"mat-label\");\n        i0.ɵɵtext(10, \"Add a task card\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"input\", 9);\n        i0.ɵɵlistener(\"ngModelChange\", function DashboardComponent_Template_input_ngModelChange_11_listener($event) {\n          return ctx.taskName = $event;\n        })(\"keyup.enter\", function DashboardComponent_Template_input_keyup_enter_11_listener() {\n          return ctx.addTask();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(12, \"button\", 10);\n        i0.ɵɵlistener(\"click\", function DashboardComponent_Template_button_click_12_listener() {\n          return ctx.addTask();\n        });\n        i0.ɵɵelementStart(13, \"mat-icon\", 11);\n        i0.ɵɵtext(14, \"add_box\");\n        i0.ɵɵelementEnd()()()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction1(4, _c1, ctx.board.bgColor));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngStyle\", i0.ɵɵpureFunction1(6, _c1, ctx.board.bgColor));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.board.tasks);\n        i0.ɵɵadvance(9);\n        i0.ɵɵproperty(\"ngModel\", ctx.taskName);\n      }\n    },\n    directives: [i6.NgStyle, i7.CdkDropListGroup, i6.NgForOf, i7.CdkDropList, i7.CdkDrag, i7.CdkDragHandle, i8.TaskComponent, i9.MatCard, i10.MatFormField, i10.MatLabel, i11.MatInput, i12.DefaultValueAccessor, i12.NgControlStatus, i12.NgModel, i13.MatButton, i10.MatSuffix, i14.MatIcon],\n    styles: [\".board[_ngcontent-%COMP%]{height:100%;width:100%}.cards-list[_ngcontent-%COMP%]{width:100%;max-width:100%;display:flex;flex-direction:row;flex-wrap:wrap;align-items:center;justify-content:center;padding-top:1rem;padding-bottom:5rem}.box[_ngcontent-%COMP%]{position:relative;text-align:center;box-sizing:border-box;margin:.5rem}.cdk-drag-handle[_ngcontent-%COMP%]{cursor:move;position:absolute;z-index:1;left:3rem;top:1rem}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.cards-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .box[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}.add-task[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0;margin:1rem;z-index:100}.form-field[_ngcontent-%COMP%]{width:50vw}.footer[_ngcontent-%COMP%]{position:fixed;bottom:0;width:100%;height:4rem;border-radius:0;z-index:100}\"]\n  });\n  return DashboardComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}